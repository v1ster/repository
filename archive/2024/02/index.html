
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="mars">
      
      
      
        <link rel="prev" href="../03/">
      
      
        <link rel="next" href="../01/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>2024/06 - Seaman's Notes</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.bcfcd587.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="lime">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#202406" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Seaman&#39;s Notes" class="md-header__button md-logo" aria-label="Seaman's Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M4 8H2.5a1 1 0 0 0-1 1v5.25a.75.75 0 0 1-1.5 0V9a2.5 2.5 0 0 1 2.5-2.5H4V5.133a1.75 1.75 0 0 1 1.533-1.737l2.831-.353.76-.913c.332-.4.825-.63 1.344-.63h.782c.966 0 1.75.784 1.75 1.75V4h2.25a.75.75 0 0 1 0 1.5H13v4h2.25a.75.75 0 0 1 0 1.5H13v.75a1.75 1.75 0 0 1-1.75 1.75h-.782c-.519 0-1.012-.23-1.344-.63l-.761-.912-2.83-.354A1.75 1.75 0 0 1 4 9.867Zm6.276-4.91-.95 1.14a.753.753 0 0 1-.483.265l-3.124.39a.25.25 0 0 0-.219.248v4.734c0 .126.094.233.219.249l3.124.39a.752.752 0 0 1 .483.264l.95 1.14a.25.25 0 0 0 .192.09h.782a.25.25 0 0 0 .25-.25v-8.5a.25.25 0 0 0-.25-.25h-.782a.25.25 0 0 0-.192.09Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Seaman's Notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              2024/06
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/v1ster/repository" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
  </div>
  <div class="md-source__repository">
    v1ster/repository
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Seaman&#39;s Notes" class="md-nav__button md-logo" aria-label="Seaman's Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M4 8H2.5a1 1 0 0 0-1 1v5.25a.75.75 0 0 1-1.5 0V9a2.5 2.5 0 0 1 2.5-2.5H4V5.133a1.75 1.75 0 0 1 1.533-1.737l2.831-.353.76-.913c.332-.4.825-.63 1.344-.63h.782c.966 0 1.75.784 1.75 1.75V4h2.25a.75.75 0 0 1 0 1.5H13v4h2.25a.75.75 0 0 1 0 1.5H13v.75a1.75 1.75 0 0 1-1.75 1.75h-.782c-.519 0-1.012-.23-1.344-.63l-.761-.912-2.83-.354A1.75 1.75 0 0 1 4 9.867Zm6.276-4.91-.95 1.14a.753.753 0 0 1-.483.265l-3.124.39a.25.25 0 0 0-.219.248v4.734c0 .126.094.233.219.249l3.124.39a.752.752 0 0 1 .483.264l.95 1.14a.25.25 0 0 0 .192.09h.782a.25.25 0 0 0 .25-.25v-8.5a.25.25 0 0 0-.25-.25h-.782a.25.25 0 0 0-.192.09Z"/></svg>

    </a>
    Seaman's Notes
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/v1ster/repository" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
  </div>
  <div class="md-source__repository">
    v1ster/repository
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blog
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../blog/tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tags
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Archive
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../2025/03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2025/08
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../2025/02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2025/04
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../2025/01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2025/01
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2024/11
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2024/08
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    
      
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    2024/06
  </span>
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2024/02
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../2023/04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2023/12
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../2023/03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2023/09
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../2023/02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2023/06
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../2018/01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2018/03
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Categories
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Categories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../category/linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    linux
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content" data-md-component="content">
    <div class="md-content__inner">
      <header class="md-typeset">
        <h1 id="202406">2024/06</h1>
      </header>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-06-27 00:00:00">June 27, 2024</time></li>
        
        
          
          <li class="md-meta__item">
            
              1 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="tmux"><a class="toclink" href="../../../tmux-%E4%BD%BF%E7%94%A8/">tmux 一些常用快捷键</a></h2>
<ol>
<li>ctrl+b d   // 分离仓库</li>
<li>tmux attach-seesion -t 0  // 回到会话</li>
<li>tmux at -t 0</li>
<li>tmux list-sessions // 列出所有会话</li>
<li>tmux ls</li>
</ol>
<h3 id="_1"><a class="toclink" href="../../../tmux-%E4%BD%BF%E7%94%A8/#_1">参考</a></h3>
<p>https://www.ruanyifeng.com/blog/2019/10/tmux.html</p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-06-26 00:00:00">June 26, 2024</time></li>
        
        
          
          <li class="md-meta__item">
            
              1 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="linux-ctrlz"><a class="toclink" href="../../../linux-%E4%B8%AD%E4%BD%BF%E7%94%A8-ctrlz-%E5%81%9C%E6%AD%A2%E4%BB%BB%E5%8A%A1%E5%90%8E%E5%A6%82%E4%BD%95%E6%81%A2%E5%A4%8D%E4%BB%BB%E5%8A%A1/">linux 中使用 ctrl+z 停止任务后如何恢复任务</a></h2>
<p>ctrl+z的作用是停止任务，要恢复停止的任务要使用fg命令</p>
<div class="language-Shell highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">[</span>root@localhost<span class="w"> </span>~<span class="o">]</span><span class="c1"># jobs</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="o">[</span><span class="m">1</span><span class="o">]</span>+<span class="w">  </span>已停止<span class="w">               </span>top
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="o">[</span>root@localhost<span class="w"> </span>~<span class="o">]</span><span class="c1"># fg 1</span>
</span></code></pre></div>
<p>fg [任务序号]，直接用fg命令，恢复的是最新停止的一条任务</p>
<h3 id="_1"><a class="toclink" href="../../../linux-%E4%B8%AD%E4%BD%BF%E7%94%A8-ctrlz-%E5%81%9C%E6%AD%A2%E4%BB%BB%E5%8A%A1%E5%90%8E%E5%A6%82%E4%BD%95%E6%81%A2%E5%A4%8D%E4%BB%BB%E5%8A%A1/#_1">参考</a></h3>
<p><a href="https://blog.csdn.net/qq_40572277/article/details/104990616#:~:text=ctrl%2Bz%E7%9A%84%E4%BD%9C%E7%94%A8%E6%98%AF%E5%81%9C%E6%AD%A2%E4%BB%BB%E5%8A%A1%EF%BC%8C%E8%A6%81%E6%81%A2%E5%A4%8D%E5%81%9C%E6%AD%A2%E7%9A%84%E4%BB%BB%E5%8A%A1%E8%A6%81%E4%BD%BF%E7%94%A8fg%E5%91%BD%E4%BB%A4%20%5B%20root%40localhost%20~%5D%20%23%20jobs%20%5B%201,%5B%20root%40localhost%20~%5D%20%23%20fg%201%20fg%20%5B%E4%BB%BB%E5%8A%A1%E5%BA%8F%E5%8F%B7%5D%EF%BC%8C%E7%9B%B4%E6%8E%A5%E7%94%A8fg%E5%91%BD%E4%BB%A4%EF%BC%8C%E6%81%A2%E5%A4%8D%E7%9A%84%E6%98%AF%E6%9C%80%E6%96%B0%E5%81%9C%E6%AD%A2%E7%9A%84%E4%B8%80%E6%9D%A1%E4%BB%BB%E5%8A%A1"> Linux中使用ctrl+z停止任务后如何恢复任务</a></p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-04-24 00:00:00">April 24, 2024</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../../category/linux/" class="md-meta__link">linux</a></li>
        
        
          
          <li class="md-meta__item">
            
              2 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="freebsd-13-gitea"><a class="toclink" href="../../../linux/%E5%9C%A8-freebsd-13-%E4%B8%8A%E5%AE%89%E8%A3%85-gitea/">在 FreeBSD 13 上安装 gitea</a></h2>
<h3 id="_1"><a class="toclink" href="../../../linux/%E5%9C%A8-freebsd-13-%E4%B8%8A%E5%AE%89%E8%A3%85-gitea/#_1">操作</a></h3>
<div class="language-Shell highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># 安装git</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>sudo<span class="w"> </span>pkg<span class="w"> </span>install<span class="w"> </span>git<span class="w"> </span>git-lfs
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># 下载gitea</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>wget<span class="w"> </span>https://dl.gitea.io/gitea/1.18.3/gitea-1.18.3-freebsd12-amd64
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>mv<span class="w"> </span>gitea-*-freebsd12-amd64<span class="w"> </span>/usr/local/bin/gitea
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>chmod<span class="w"> </span>+x<span class="w"> </span>/usr/local/bin/gitea
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="c1"># 创建用户</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="o">[</span>root@freebsd<span class="w"> </span>~<span class="o">]</span><span class="c1"># adduser</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>Username:<span class="w"> </span>git
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>Full<span class="w"> </span>name:
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>Uid<span class="w"> </span><span class="o">(</span>Leave<span class="w"> </span>empty<span class="w"> </span><span class="k">for</span><span class="w"> </span>default<span class="o">)</span>:
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>Login<span class="w"> </span>group<span class="w"> </span><span class="o">[</span>git<span class="o">]</span>:
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>Login<span class="w"> </span>group<span class="w"> </span>is<span class="w"> </span>git.<span class="w"> </span>Invite<span class="w"> </span>git<span class="w"> </span>into<span class="w"> </span>other<span class="w"> </span>groups?<span class="w"> </span><span class="o">[]</span>:
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>Login<span class="w"> </span>class<span class="w"> </span><span class="o">[</span>default<span class="o">]</span>:
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>Shell<span class="w"> </span><span class="o">(</span>sh<span class="w"> </span>csh<span class="w"> </span>tcsh<span class="w"> </span>bash<span class="w"> </span>rbash<span class="w"> </span>git-shell<span class="w"> </span>nologin<span class="o">)</span><span class="w"> </span><span class="o">[</span>sh<span class="o">]</span>:
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>Home<span class="w"> </span>directory<span class="w"> </span><span class="o">[</span>/home/git<span class="o">]</span>:
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>Home<span class="w"> </span>directory<span class="w"> </span>permissions<span class="w"> </span><span class="o">(</span>Leave<span class="w"> </span>empty<span class="w"> </span><span class="k">for</span><span class="w"> </span>default<span class="o">)</span>:
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>Use<span class="w"> </span>password-based<span class="w"> </span>authentication?<span class="w"> </span><span class="o">[</span>yes<span class="o">]</span>:<span class="w"> </span>no
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>Lock<span class="w"> </span>out<span class="w"> </span>the<span class="w"> </span>account<span class="w"> </span>after<span class="w"> </span>creation?<span class="w"> </span><span class="o">[</span>no<span class="o">]</span>:
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>Username<span class="w">   </span>:<span class="w"> </span>git
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>Password<span class="w">   </span>:<span class="w"> </span>&lt;disabled&gt;
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>Full<span class="w"> </span>Name<span class="w">  </span>:
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>Uid<span class="w">        </span>:<span class="w"> </span><span class="m">1002</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>Class<span class="w">      </span>:
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>Groups<span class="w">     </span>:<span class="w"> </span>git
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>Home<span class="w">       </span>:<span class="w"> </span>/home/git
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>Home<span class="w"> </span>Mode<span class="w">  </span>:
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>Shell<span class="w">      </span>:<span class="w"> </span>/bin/sh
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>Locked<span class="w">     </span>:<span class="w"> </span>no
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>OK?<span class="w"> </span><span class="o">(</span>yes/no<span class="o">)</span>:<span class="w"> </span>yes
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>adduser:<span class="w"> </span>INFO:<span class="w"> </span>Successfully<span class="w"> </span>added<span class="w"> </span><span class="o">(</span>git<span class="o">)</span><span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>user<span class="w"> </span>database.
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>Add<span class="w"> </span>another<span class="w"> </span>user?<span class="w"> </span><span class="o">(</span>yes/no<span class="o">)</span>:<span class="w"> </span>no
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>Goodbye!
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="c1"># 启动服务</span>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>mkdir<span class="w"> </span>-p<span class="w"> </span>/var/lib/gitea/<span class="o">{</span>custom,data,log<span class="o">}</span>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>chown<span class="w"> </span>-R<span class="w"> </span>git:git<span class="w"> </span>/var/lib/gitea
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a>chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">750</span><span class="w"> </span>/var/lib/gitea
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a><span class="c1"># 编写rc 启动脚本 /usr/local/etc/rc.d/gitea</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a><span class="c1">#!/bin/sh</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a><span class="c1">#</span>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a><span class="c1"># $FreeBSD$</span>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a><span class="c1">#</span>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a><span class="c1"># PROVIDE: gitea</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a><span class="c1"># REQUIRE: NETWORKING SYSLOG</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a><span class="c1"># KEYWORD: shutdown</span>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a><span class="c1">#</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a><span class="c1"># Add the following lines to /etc/rc.conf to enable gitea:</span>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a><span class="c1">#</span>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a><span class="c1">#   gitea_enable=&quot;YES&quot;</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a><span class="c1">#</span>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a><span class="c1"># https://github.com/go-gitea/gitea/blob/main/contrib/init/freebsd/gitea</span>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a>.<span class="w"> </span>/etc/rc.subr
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;gitea&quot;</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a><span class="nv">rcvar</span><span class="o">=</span><span class="s2">&quot;gitea_enable&quot;</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62" href="#__codelineno-0-62"></a>load_rc_config<span class="w"> </span><span class="nv">$name</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63" href="#__codelineno-0-63"></a>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64" href="#__codelineno-0-64"></a>:<span class="w"> </span><span class="si">${</span><span class="nv">gitea_user</span><span class="p">:=</span><span class="s2">&quot;git&quot;</span><span class="si">}</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65" href="#__codelineno-0-65"></a>:<span class="w"> </span><span class="si">${</span><span class="nv">gitea_enable</span><span class="p">:=</span><span class="s2">&quot;NO&quot;</span><span class="si">}</span>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66" href="#__codelineno-0-66"></a>:<span class="w"> </span><span class="si">${</span><span class="nv">gitea_directory</span><span class="p">:=</span><span class="s2">&quot;/var/lib/gitea&quot;</span><span class="si">}</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67" href="#__codelineno-0-67"></a>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68" href="#__codelineno-0-68"></a><span class="nv">command</span><span class="o">=</span><span class="s2">&quot;/usr/local/bin/gitea web&quot;</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69" href="#__codelineno-0-69"></a><span class="nv">procname</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="nv">$command</span><span class="w"> </span><span class="p">|</span>cut<span class="w"> </span>-d<span class="s1">&#39; &#39;</span><span class="w"> </span>-f1<span class="k">)</span><span class="s2">&quot;</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70" href="#__codelineno-0-70"></a>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71" href="#__codelineno-0-71"></a><span class="nv">pidfile</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">gitea_directory</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">name</span><span class="si">}</span><span class="s2">.pid&quot;</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72" href="#__codelineno-0-72"></a>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73" href="#__codelineno-0-73"></a><span class="nv">start_cmd</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">name</span><span class="si">}</span><span class="s2">_start&quot;</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74" href="#__codelineno-0-74"></a><span class="nv">stop_cmd</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">name</span><span class="si">}</span><span class="s2">_stop&quot;</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75" href="#__codelineno-0-75"></a>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76" href="#__codelineno-0-76"></a>gitea_start<span class="o">()</span><span class="w"> </span><span class="o">{</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77" href="#__codelineno-0-77"></a><span class="w">    </span><span class="nb">cd</span><span class="w"> </span><span class="si">${</span><span class="nv">gitea_directory</span><span class="si">}</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78" href="#__codelineno-0-78"></a><span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">USER</span><span class="o">=</span><span class="si">${</span><span class="nv">gitea_user</span><span class="si">}</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79" href="#__codelineno-0-79"></a><span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">HOME</span><span class="o">=</span>/home/<span class="si">${</span><span class="nv">gitea_user</span><span class="si">}</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80" href="#__codelineno-0-80"></a><span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">GITEA_WORK_DIR</span><span class="o">=</span><span class="si">${</span><span class="nv">gitea_directory</span><span class="si">}</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81" href="#__codelineno-0-81"></a><span class="w">    </span>/usr/sbin/daemon<span class="w"> </span>-f<span class="w"> </span>-u<span class="w"> </span><span class="si">${</span><span class="nv">gitea_user</span><span class="si">}</span><span class="w"> </span>-p<span class="w"> </span><span class="si">${</span><span class="nv">pidfile</span><span class="si">}</span><span class="w"> </span><span class="nv">$command</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82" href="#__codelineno-0-82"></a><span class="o">}</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83" href="#__codelineno-0-83"></a>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84" href="#__codelineno-0-84"></a>gitea_stop<span class="o">()</span><span class="w"> </span><span class="o">{</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85" href="#__codelineno-0-85"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>!<span class="w"> </span>-f<span class="w"> </span><span class="nv">$pidfile</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86" href="#__codelineno-0-86"></a><span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;GITEA PID File not found. Maybe GITEA is not running?&quot;</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87" href="#__codelineno-0-87"></a><span class="w">    </span><span class="k">else</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88" href="#__codelineno-0-88"></a><span class="w">        </span><span class="nb">kill</span><span class="w"> </span><span class="k">$(</span>cat<span class="w"> </span><span class="nv">$pidfile</span><span class="k">)</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89" href="#__codelineno-0-89"></a><span class="w">    </span><span class="k">fi</span>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90" href="#__codelineno-0-90"></a><span class="o">}</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91" href="#__codelineno-0-91"></a>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92" href="#__codelineno-0-92"></a>run_rc_command<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93" href="#__codelineno-0-93"></a>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94" href="#__codelineno-0-94"></a><span class="c1"># 编辑rc脚本权限</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95" href="#__codelineno-0-95"></a>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96" href="#__codelineno-0-96"></a>chmod<span class="w"> </span><span class="m">755</span><span class="w"> </span>/usr/local/etc/rc.d/gitea
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97" href="#__codelineno-0-97"></a>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98" href="#__codelineno-0-98"></a><span class="c1"># 启动服务</span>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99" href="#__codelineno-0-99"></a>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100" href="#__codelineno-0-100"></a>sysrc<span class="w"> </span><span class="s1">&#39;gitea_enable=YES&#39;</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101" href="#__codelineno-0-101"></a>service<span class="w"> </span>gitea<span class="w"> </span>start
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102" href="#__codelineno-0-102"></a><span class="c1"># 访问web 站点初始化</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103" href="#__codelineno-0-103"></a>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104" href="#__codelineno-0-104"></a>http://192.168.1.3:3000
</span></code></pre></div>
<h2 id="trubleshooting"><a class="toclink" href="../../../linux/%E5%9C%A8-freebsd-13-%E4%B8%8A%E5%AE%89%E8%A3%85-gitea/#trubleshooting">trubleshooting</a></h2>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">(</span>.venv<span class="o">)</span><span class="w"> </span><span class="o">[</span>mars@mapc<span class="w"> </span>~/workspace/pyground/encrypted_bin<span class="o">]</span>$<span class="w"> </span>git<span class="w"> </span>push<span class="w"> </span>upstream<span class="w"> </span>master
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>Enumerating<span class="w"> </span>objects:<span class="w"> </span><span class="m">21</span>,<span class="w"> </span><span class="k">done</span>.
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>Counting<span class="w"> </span>objects:<span class="w"> </span><span class="m">100</span>%<span class="w"> </span><span class="o">(</span><span class="m">21</span>/21<span class="o">)</span>,<span class="w"> </span><span class="k">done</span>.
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>Delta<span class="w"> </span>compression<span class="w"> </span>using<span class="w"> </span>up<span class="w"> </span>to<span class="w"> </span><span class="m">16</span><span class="w"> </span>threads
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>Compressing<span class="w"> </span>objects:<span class="w"> </span><span class="m">100</span>%<span class="w"> </span><span class="o">(</span><span class="m">19</span>/19<span class="o">)</span>,<span class="w"> </span><span class="k">done</span>.
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>Writing<span class="w"> </span>objects:<span class="w"> </span><span class="m">100</span>%<span class="w"> </span><span class="o">(</span><span class="m">21</span>/21<span class="o">)</span>,<span class="w"> </span><span class="m">222</span>.82<span class="w"> </span>KiB<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">4</span>.55<span class="w"> </span>MiB/s,<span class="w"> </span><span class="k">done</span>.
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>Total<span class="w"> </span><span class="m">21</span><span class="w"> </span><span class="o">(</span>delta<span class="w"> </span><span class="m">6</span><span class="o">)</span>,<span class="w"> </span>reused<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>delta<span class="w"> </span><span class="m">0</span><span class="o">)</span>,<span class="w"> </span>pack-reused<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">(</span>from<span class="w"> </span><span class="m">0</span><span class="o">)</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>remote:<span class="w"> </span>env:<span class="w"> </span>bash:<span class="w"> </span>No<span class="w"> </span>such<span class="w"> </span>file<span class="w"> </span>or<span class="w"> </span>directory
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>To<span class="w"> </span><span class="m">192</span>.168.1.3:workspace/encrypted_bin.git
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="w"> </span>!<span class="w"> </span><span class="o">[</span>remote<span class="w"> </span>rejected<span class="o">]</span><span class="w"> </span>master<span class="w"> </span>-&gt;<span class="w"> </span>master<span class="w"> </span><span class="o">(</span>pre-receive<span class="w"> </span>hook<span class="w"> </span>declined<span class="o">)</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>error:<span class="w"> </span>failed<span class="w"> </span>to<span class="w"> </span>push<span class="w"> </span>some<span class="w"> </span>refs<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;192.168.1.3:workspace/encrypted_bin.git&#39;</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="c1"># freebse 没有bash, 需要手动安装</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>sudo<span class="w"> </span>pkg<span class="w"> </span>install<span class="w"> </span>bash
</span></code></pre></div>
<h3 id="_2"><a class="toclink" href="../../../linux/%E5%9C%A8-freebsd-13-%E4%B8%8A%E5%AE%89%E8%A3%85-gitea/#_2">参考</a></h3>
<p><a href="https://www.cnblogs.com/Gitea/p/setup-gitea-on-freebsd.html">在 FreeBSD 12 上安装 Gitea</a></p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-04-14 00:00:00">April 14, 2024</time></li>
        
        
          
          <li class="md-meta__item">
            
              3 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="ext4-btrfs"><a class="toclink" href="../../../arch-linux-ext4-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E8%BD%AC-btrfs/">ext4 文件系统转为 Btrfs</a></h2>
<blockquote>
<p>注意所有操作在LiveCD 环境下进行操作</p>
</blockquote>
<ol>
<li>检查文件系统保证现有分区没有问题
<div class="language-Shell highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>fsck.ext4<span class="w"> </span>/dev/nvme0n1p3
</span></code></pre></div></li>
<li>文件系统转换
<div class="language-Shell highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>btrfs-convert<span class="w"> </span>/dev/nvme0n1p3
</span></code></pre></div></li>
<li>挂载分区并修改fstab
<div class="language-Shell highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>mount<span class="w"> </span>/dev/nvme0n1p3<span class="w"> </span>/mnt
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>mount<span class="w"> </span>/dev/nvme0n1p4<span class="w"> </span>/mnt/home
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>mount<span class="w"> </span>/dev/nvme0n1p1<span class="w"> </span>/mnt/boot
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>sweapon<span class="w"> </span>/dev/nvme0n1p2
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>mount<span class="w"> </span>-t<span class="w"> </span>proc<span class="w"> </span>none<span class="w"> </span>/mnt/proc
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>mount<span class="w"> </span>-t<span class="w"> </span>sysfs<span class="w"> </span>none<span class="w"> </span>/mnt/sys
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>mount<span class="w"> </span>-o<span class="w"> </span><span class="nb">bind</span><span class="w"> </span>/dev<span class="w"> </span>/mnt/dev
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>genfstab<span class="w"> </span>-U<span class="w"> </span>/mnt<span class="w"> </span>&gt;<span class="w"> </span>/mnt/etc/fstab
</span></code></pre></div></li>
<li>使用 <code>pacstrap</code> 脚本安装基础包：
<div class="language-Shell highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>arch-chroot<span class="w"> </span>/mnt
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>pacstrap<span class="w"> </span>/mnt<span class="w"> </span>base<span class="w"> </span>base-devel<span class="w"> </span>linux<span class="w"> </span>linux-firmware<span class="w"> </span>btrfs-progs
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="c1"># 如果使用btrfs文件系统，额外安装一个btrfs-progs包</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>pacstrap<span class="w"> </span>/mnt<span class="w"> </span>networkmanager<span class="w"> </span>vim<span class="w"> </span>sudo<span class="w"> </span>zsh<span class="w"> </span>zsh-completions
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>mkinitcpio<span class="w"> </span>-P
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="nb">exit</span>
</span></code></pre></div></li>
<li>启用透明压缩
<div class="language-Shell highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>btrfs<span class="w"> </span>filesystem<span class="w"> </span>defragment<span class="w"> </span>-r<span class="w"> </span>-v<span class="w"> </span>-czstd<span class="w"> </span>/mnt
</span></code></pre></div></li>
<li>使用balance 来回收数据
<div class="language-Shell highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>btrfs<span class="w"> </span>subvolume<span class="w"> </span>delete<span class="w"> </span>/mnt/ext2_saved
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>btrfs<span class="w"> </span>balance<span class="w"> </span>start<span class="w"> </span>/mnt
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>btrfs<span class="w"> </span>balance<span class="w"> </span>status<span class="w"> </span>/mnt
</span></code></pre></div></li>
</ol>
<h2 id="_1"><a class="toclink" href="../../../arch-linux-ext4-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E8%BD%AC-btrfs/#_1">根目录文件迁移到子卷</a></h2>
<ol>
<li>创建子卷
<div class="language-Shell highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>sudo<span class="w"> </span>btrfs<span class="w"> </span>subvolume<span class="w"> </span>create<span class="w"> </span>/mnt/@
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>sudo<span class="w"> </span>btrfs<span class="w"> </span>subvolume<span class="w"> </span>create<span class="w"> </span>/mnt/@home
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>sudo<span class="w"> </span>btrfs<span class="w"> </span>subvol<span class="w"> </span>list<span class="w"> </span>/mnt
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>ID<span class="w"> </span><span class="m">256</span><span class="w"> </span>gen<span class="w"> </span><span class="m">3500</span><span class="w"> </span>top<span class="w"> </span>level<span class="w"> </span><span class="m">5</span><span class="w"> </span>path<span class="w"> </span>@
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>ID<span class="w"> </span><span class="m">258</span><span class="w"> </span>gen<span class="w"> </span><span class="m">3500</span><span class="w"> </span>top<span class="w"> </span>level<span class="w"> </span><span class="m">5</span><span class="w"> </span>path<span class="w"> </span>@home
</span></code></pre></div></li>
<li>同步子区文件
<div class="language-Shell highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>rsync<span class="w"> </span>-a<span class="w"> </span>/mnt<span class="w"> </span>/mnt/@
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>rsync<span class="w"> </span>-a<span class="w"> </span>/mnt/home<span class="w"> </span>/mnt/@home
</span></code></pre></div></li>
<li>挂载分区并修改fstab<blockquote>
<p>这里要注意重新挂载其他的分区
<div class="language-Shell highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>mount<span class="w"> </span>-t<span class="w"> </span>btrfs<span class="w"> </span>-o<span class="w"> </span><span class="nv">subvol</span><span class="o">=</span>/@,compress<span class="o">=</span>zstd<span class="w"> </span>/dev//dev/nvme0n1p3<span class="w"> </span>/mnt
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>mount<span class="w"> </span>-t<span class="w"> </span>btrfs<span class="w"> </span>-o<span class="w"> </span><span class="nv">subvol</span><span class="o">=</span>/@home,compress<span class="o">=</span>zstd<span class="w"> </span>/dev//dev/nvme0n1p3<span class="w"> </span>/mnt/home
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>genfstab<span class="w"> </span>-U<span class="w"> </span>/mnt<span class="w"> </span>&gt;<span class="w"> </span>/mnt/etc/fstab
</span></code></pre></div></p>
</blockquote>
</li>
<li>修改systemd-boot 引导
<div class="language-Shell highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>sudo<span class="w"> </span>blkid<span class="w"> </span>-p<span class="w"> </span>/dev/nvme0n1p3
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>ls<span class="w"> </span>/dev/disk/by-partuuid<span class="w"> </span>-la
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>total<span class="w"> </span><span class="m">0</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>drwxr-xr-x<span class="w"> </span><span class="m">2</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">160</span><span class="w"> </span>Apr<span class="w"> </span><span class="m">14</span><span class="w"> </span><span class="m">16</span>:07<span class="w"> </span>.
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>drwxr-xr-x<span class="w"> </span><span class="m">8</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">160</span><span class="w"> </span>Apr<span class="w"> </span><span class="m">14</span><span class="w"> </span><span class="m">16</span>:07<span class="w"> </span>..
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>lrwxrwxrwx<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">  </span><span class="m">15</span><span class="w"> </span>Apr<span class="w"> </span><span class="m">14</span><span class="w"> </span><span class="m">16</span>:07<span class="w"> </span>1f52178e-ace5-43c8-a25a-666b6975533a<span class="w"> </span>-&gt;<span class="w"> </span>../../nvme1n1p2
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>lrwxrwxrwx<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">  </span><span class="m">15</span><span class="w"> </span>Apr<span class="w"> </span><span class="m">14</span><span class="w"> </span><span class="m">16</span>:07<span class="w"> </span>73d99787-e061-4aef-a610-278463f96cf6<span class="w"> </span>-&gt;<span class="w"> </span>../../nvme0n1p3
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>lrwxrwxrwx<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">  </span><span class="m">15</span><span class="w"> </span>Apr<span class="w"> </span><span class="m">14</span><span class="w"> </span><span class="m">16</span>:07<span class="w"> </span>99ef2922-a9df-49e1-a193-d48b7fc9a40a<span class="w"> </span>-&gt;<span class="w"> </span>../../nvme0n1p2
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>lrwxrwxrwx<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">  </span><span class="m">15</span><span class="w"> </span>Apr<span class="w"> </span><span class="m">14</span><span class="w"> </span><span class="m">16</span>:07<span class="w"> </span>b339edf8-ea40-459e-b26d-dd70d49064b4<span class="w"> </span>-&gt;<span class="w"> </span>../../nvme1n1p3
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>lrwxrwxrwx<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">  </span><span class="m">15</span><span class="w"> </span>Apr<span class="w"> </span><span class="m">14</span><span class="w"> </span><span class="m">16</span>:07<span class="w"> </span>be3bb32f-6193-472d-be7d-1a4f9f5d682e<span class="w"> </span>-&gt;<span class="w"> </span>../../nvme0n1p1
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>lrwxrwxrwx<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">  </span><span class="m">15</span><span class="w"> </span>Apr<span class="w"> </span><span class="m">14</span><span class="w"> </span><span class="m">16</span>:07<span class="w"> </span>c84bac03-8a3a-4f9e-a121-3a00d9187be3<span class="w"> </span>-&gt;<span class="w"> </span>../../nvme1n1p1
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a>vim<span class="w"> </span>/boot/loader/entries/arch.conf<span class="w">  </span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a>title<span class="w">   </span>Arch<span class="w"> </span>Linux
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a>linux<span class="w">   </span>/vmlinuz-linux
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a>initrd<span class="w">  </span>/amd-ucode.img
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a>initrd<span class="w">  </span>/initramfs-linux.img
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a>options<span class="w"> </span><span class="nv">root</span><span class="o">=</span><span class="nv">PARTUUID</span><span class="o">=</span>73d99787-e061-4aef-a610-278463f96cf6<span class="w"> </span>rw<span class="w"> </span><span class="nv">rootflags</span><span class="o">=</span><span class="nv">subvol</span><span class="o">=</span>/@
</span></code></pre></div></li>
</ol>
<h2 id="_2"><a class="toclink" href="../../../arch-linux-ext4-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E8%BD%AC-btrfs/#_2">修改分区大小</a></h2>
<div class="language-Shell highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="o">[</span>mars@mapc<span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>sudo<span class="w"> </span>fdisk<span class="w"> </span>/dev/nvme0n1<span class="w">               </span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>Welcome<span class="w"> </span>to<span class="w"> </span>fdisk<span class="w"> </span><span class="o">(</span>util-linux<span class="w"> </span><span class="m">2</span>.40<span class="o">)</span>.
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>Changes<span class="w"> </span>will<span class="w"> </span>remain<span class="w"> </span><span class="k">in</span><span class="w"> </span>memory<span class="w"> </span>only,<span class="w"> </span><span class="k">until</span><span class="w"> </span>you<span class="w"> </span>decide<span class="w"> </span>to<span class="w"> </span>write<span class="w"> </span>them.
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>Be<span class="w"> </span>careful<span class="w"> </span>before<span class="w"> </span>using<span class="w"> </span>the<span class="w"> </span>write<span class="w"> </span>command.
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>This<span class="w"> </span>disk<span class="w"> </span>is<span class="w"> </span>currently<span class="w"> </span><span class="k">in</span><span class="w"> </span>use<span class="w"> </span>-<span class="w"> </span>repartitioning<span class="w"> </span>is<span class="w"> </span>probably<span class="w"> </span>a<span class="w"> </span>bad<span class="w"> </span>idea.
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>It<span class="err">&#39;</span>s<span class="w"> </span>recommended<span class="w"> </span>to<span class="w"> </span>umount<span class="w"> </span>all<span class="w"> </span>file<span class="w"> </span>systems,<span class="w"> </span>and<span class="w"> </span>swapoff<span class="w"> </span>all<span class="w"> </span>swap
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>partitions<span class="w"> </span>on<span class="w"> </span>this<span class="w"> </span>disk.
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>Command<span class="w"> </span><span class="o">(</span>m<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nb">help</span><span class="o">)</span>:<span class="w"> </span>e
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>Partition<span class="w"> </span>number<span class="w"> </span><span class="o">(</span><span class="m">1</span>-3,<span class="w"> </span>default<span class="w"> </span><span class="m">3</span><span class="o">)</span>:<span class="w">  </span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a>New<span class="w"> </span>&lt;size&gt;<span class="o">{</span>K,M,G,T,P<span class="o">}</span><span class="w"> </span><span class="k">in</span><span class="w"> </span>bytes<span class="w"> </span>or<span class="w"> </span>&lt;size&gt;S<span class="w"> </span><span class="k">in</span><span class="w"> </span>sectors<span class="w"> </span><span class="o">(</span>default<span class="w"> </span>915G<span class="o">)</span>:<span class="w">  </span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a>Partition<span class="w"> </span><span class="m">3</span><span class="w"> </span>has<span class="w"> </span>been<span class="w"> </span>resized.
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a>Command<span class="w"> </span><span class="o">(</span>m<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nb">help</span><span class="o">)</span>:<span class="w"> </span>w
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a>The<span class="w"> </span>partition<span class="w"> </span>table<span class="w"> </span>has<span class="w"> </span>been<span class="w"> </span>altered.
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a>Syncing<span class="w"> </span>disks.
</span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a><span class="o">[</span>mars@mapc<span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>df<span class="w"> </span>-h<span class="w">                   </span>
</span><span id="__span-10-23"><a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a>Filesystem<span class="w">      </span>Size<span class="w">  </span>Used<span class="w"> </span>Avail<span class="w"> </span>Use%<span class="w"> </span>Mounted<span class="w"> </span>on
</span><span id="__span-10-24"><a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a>dev<span class="w">             </span><span class="m">7</span>.5G<span class="w">     </span><span class="m">0</span><span class="w">  </span><span class="m">7</span>.5G<span class="w">   </span><span class="m">0</span>%<span class="w"> </span>/dev
</span><span id="__span-10-25"><a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a>run<span class="w">             </span><span class="m">7</span>.5G<span class="w">  </span><span class="m">1</span>.9M<span class="w">  </span><span class="m">7</span>.5G<span class="w">   </span><span class="m">1</span>%<span class="w"> </span>/run
</span><span id="__span-10-26"><a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a>efivarfs<span class="w">        </span>148K<span class="w">  </span>126K<span class="w">   </span>18K<span class="w">  </span><span class="m">88</span>%<span class="w"> </span>/sys/firmware/efi/efivars
</span><span id="__span-10-27"><a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a>/dev/nvme0n1p3<span class="w">  </span>512G<span class="w">   </span>40G<span class="w">  </span>471G<span class="w">   </span><span class="m">8</span>%<span class="w"> </span>/
</span><span id="__span-10-28"><a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a>tmpfs<span class="w">           </span><span class="m">7</span>.5G<span class="w">  </span>169M<span class="w">  </span><span class="m">7</span>.4G<span class="w">   </span><span class="m">3</span>%<span class="w"> </span>/dev/shm
</span><span id="__span-10-29"><a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a>/dev/nvme0n1p3<span class="w">  </span>512G<span class="w">   </span>40G<span class="w">  </span>471G<span class="w">   </span><span class="m">8</span>%<span class="w"> </span>/home
</span><span id="__span-10-30"><a id="__codelineno-10-30" name="__codelineno-10-30" href="#__codelineno-10-30"></a>/dev/nvme0n1p1<span class="w">  </span>511M<span class="w">  </span>297M<span class="w">  </span>215M<span class="w">  </span><span class="m">59</span>%<span class="w"> </span>/boot
</span><span id="__span-10-31"><a id="__codelineno-10-31" name="__codelineno-10-31" href="#__codelineno-10-31"></a>tmpfs<span class="w">           </span><span class="m">7</span>.5G<span class="w">   </span>29M<span class="w">  </span><span class="m">7</span>.5G<span class="w">   </span><span class="m">1</span>%<span class="w"> </span>/tmp
</span><span id="__span-10-32"><a id="__codelineno-10-32" name="__codelineno-10-32" href="#__codelineno-10-32"></a>tmpfs<span class="w">           </span><span class="m">1</span>.5G<span class="w">   </span>76K<span class="w">  </span><span class="m">1</span>.5G<span class="w">   </span><span class="m">1</span>%<span class="w"> </span>/run/user/1000
</span><span id="__span-10-33"><a id="__codelineno-10-33" name="__codelineno-10-33" href="#__codelineno-10-33"></a>/dev/nvme0n1p3<span class="w">  </span>512G<span class="w">   </span>40G<span class="w">  </span>471G<span class="w">   </span><span class="m">8</span>%<span class="w"> </span>/mnt
</span><span id="__span-10-34"><a id="__codelineno-10-34" name="__codelineno-10-34" href="#__codelineno-10-34"></a><span class="o">[</span>mars@mapc<span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>sudo<span class="w"> </span>btrfs<span class="w"> </span>filesystem<span class="w"> </span>resize<span class="w"> </span>max<span class="w"> </span>/mnt
</span><span id="__span-10-35"><a id="__codelineno-10-35" name="__codelineno-10-35" href="#__codelineno-10-35"></a>Resize<span class="w"> </span>device<span class="w"> </span>id<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">(</span>/dev/nvme0n1p3<span class="o">)</span><span class="w"> </span>from<span class="w"> </span><span class="m">512</span>.00GiB<span class="w"> </span>to<span class="w"> </span>max
</span><span id="__span-10-36"><a id="__codelineno-10-36" name="__codelineno-10-36" href="#__codelineno-10-36"></a><span class="o">[</span>mars@mapc<span class="w"> </span>~<span class="o">]</span>$<span class="w"> </span>df<span class="w"> </span>-h<span class="w">                                 </span>
</span><span id="__span-10-37"><a id="__codelineno-10-37" name="__codelineno-10-37" href="#__codelineno-10-37"></a>Filesystem<span class="w">      </span>Size<span class="w">  </span>Used<span class="w"> </span>Avail<span class="w"> </span>Use%<span class="w"> </span>Mounted<span class="w"> </span>on
</span><span id="__span-10-38"><a id="__codelineno-10-38" name="__codelineno-10-38" href="#__codelineno-10-38"></a>dev<span class="w">             </span><span class="m">7</span>.5G<span class="w">     </span><span class="m">0</span><span class="w">  </span><span class="m">7</span>.5G<span class="w">   </span><span class="m">0</span>%<span class="w"> </span>/dev
</span><span id="__span-10-39"><a id="__codelineno-10-39" name="__codelineno-10-39" href="#__codelineno-10-39"></a>run<span class="w">             </span><span class="m">7</span>.5G<span class="w">  </span><span class="m">1</span>.9M<span class="w">  </span><span class="m">7</span>.5G<span class="w">   </span><span class="m">1</span>%<span class="w"> </span>/run
</span><span id="__span-10-40"><a id="__codelineno-10-40" name="__codelineno-10-40" href="#__codelineno-10-40"></a>efivarfs<span class="w">        </span>148K<span class="w">  </span>126K<span class="w">   </span>18K<span class="w">  </span><span class="m">88</span>%<span class="w"> </span>/sys/firmware/efi/efivars
</span><span id="__span-10-41"><a id="__codelineno-10-41" name="__codelineno-10-41" href="#__codelineno-10-41"></a>/dev/nvme0n1p3<span class="w">  </span>916G<span class="w">   </span>40G<span class="w">  </span>874G<span class="w">   </span><span class="m">5</span>%<span class="w"> </span>/
</span><span id="__span-10-42"><a id="__codelineno-10-42" name="__codelineno-10-42" href="#__codelineno-10-42"></a>tmpfs<span class="w">           </span><span class="m">7</span>.5G<span class="w">  </span>169M<span class="w">  </span><span class="m">7</span>.4G<span class="w">   </span><span class="m">3</span>%<span class="w"> </span>/dev/shm
</span><span id="__span-10-43"><a id="__codelineno-10-43" name="__codelineno-10-43" href="#__codelineno-10-43"></a>/dev/nvme0n1p3<span class="w">  </span>916G<span class="w">   </span>40G<span class="w">  </span>874G<span class="w">   </span><span class="m">5</span>%<span class="w"> </span>/home
</span><span id="__span-10-44"><a id="__codelineno-10-44" name="__codelineno-10-44" href="#__codelineno-10-44"></a>/dev/nvme0n1p1<span class="w">  </span>511M<span class="w">  </span>297M<span class="w">  </span>215M<span class="w">  </span><span class="m">59</span>%<span class="w"> </span>/boot
</span><span id="__span-10-45"><a id="__codelineno-10-45" name="__codelineno-10-45" href="#__codelineno-10-45"></a>tmpfs<span class="w">           </span><span class="m">7</span>.5G<span class="w">   </span>29M<span class="w">  </span><span class="m">7</span>.5G<span class="w">   </span><span class="m">1</span>%<span class="w"> </span>/tmp
</span><span id="__span-10-46"><a id="__codelineno-10-46" name="__codelineno-10-46" href="#__codelineno-10-46"></a>tmpfs<span class="w">           </span><span class="m">1</span>.5G<span class="w">   </span>76K<span class="w">  </span><span class="m">1</span>.5G<span class="w">   </span><span class="m">1</span>%<span class="w"> </span>/run/user/1000
</span><span id="__span-10-47"><a id="__codelineno-10-47" name="__codelineno-10-47" href="#__codelineno-10-47"></a>/dev/nvme0n1p3<span class="w">  </span>916G<span class="w">   </span>40G<span class="w">  </span>874G<span class="w">   </span><span class="m">5</span>%<span class="w"> </span>/mnt
</span></code></pre></div>
<h3 id="_3"><a class="toclink" href="../../../arch-linux-ext4-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E8%BD%AC-btrfs/#_3">参考</a></h3>
<p><a href="https://blog.kaaass.net/archives/1748">Btrfs：认识、从 Ext4 迁移与快照方案</a>
<a href="https://arch.icekylin.online/guide/rookie/basic-install#archlinux-%E5%9F%BA%E7%A1%80%E5%AE%89%E8%A3%85">archlinux 基础安装​</a>
<a href="https://wiki.archlinux.org/title/TLP">TLP</a>
<a href="https://zhuanlan.zhihu.com/p/385843857">将 Arch Linux 内核从 stable 更换为 LTS 的办法与案例</a>
<a href="https://wiki.archlinux.org/title/Kernel">Kernel</a>
<a href="https://blog.samchu.cn/posts/linux-ext4-to-btrfs/">Linux ext4 文件系统转 Btrfs</a></p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-04-14 00:00:00">April 14, 2024</time></li>
        
        
          
          <li class="md-meta__item">
            
              1 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="zsh"><a class="toclink" href="../../../zsh-%E5%A2%9E%E5%8A%A0%E5%91%BD%E4%BB%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/">zsh 增加命令历史记录</a></h2>
<h3 id="_1"><a class="toclink" href="../../../zsh-%E5%A2%9E%E5%8A%A0%E5%91%BD%E4%BB%A4%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95/#_1">参考</a></h3>
<p><a href="https://unix.stackexchange.com/questions/389881/history-isnt-preserved-in-zsh">history isn't preserved in zsh</a></p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2024-04-11 00:00:00">April 11, 2024</time></li>
        
        
          
          <li class="md-meta__item">
            
              1 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="freebsd-13-samba-server"><a class="toclink" href="../../../freebsd-13-%E5%AE%89%E8%A3%85-samba-server/">freebsd 13 安装 samba server</a></h2>
<h3 id="_1"><a class="toclink" href="../../../freebsd-13-%E5%AE%89%E8%A3%85-samba-server/#_1">内核优化</a></h3>
<p>Edit <code>/etc/sysctl.conf</code></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>kern.maxfiles=25600
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>kern.maxfilesperproc=16384
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>net.inet.tcp.sendspace=65536
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>net.inet.tcp.recvspace=65536
</span></code></pre></div>
<p>enable asynchronous I/O.This can be accomplished by adding the following line to the file <code>/boot/loader.conf</code>:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>aio_load=&quot;YES&quot;
</span></code></pre></div>
<p>To get it working without restarting, additionally execute the following command:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>kldload<span class="w"> </span>aio
</span></code></pre></div>
<h3 id="installation"><a class="toclink" href="../../../freebsd-13-%E5%AE%89%E8%A3%85-samba-server/#installation">Installation</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>pkg search samba4
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>samba413-4.13.17_8             Free SMB/CIFS and AD/DC server and client for Unix
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>samba416-4.16.11_2             Free SMB/CIFS and AD/DC server and client for Unix
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>sudo pkg install samba416
</span></code></pre></div>
<h3 id="config"><a class="toclink" href="../../../freebsd-13-%E5%AE%89%E8%A3%85-samba-server/#config">Config</a></h3>
<p>create a file called <code>/usr/local/etc/smb4.conf</code></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>[global]
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>    workgroup = MYGROUP
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>    realm = mygroup.local
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    netbios name = NAS
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>[davd data]
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>    path = /home/davd
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>    public = no
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>    writable = yes
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>    printable = no
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>    guest ok = no
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>    valid users = davd
</span></code></pre></div>
<p>Then just enable Samba and start it:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>sysrc<span class="w"> </span><span class="nv">samba_server_enable</span><span class="o">=</span>YES
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>service<span class="w"> </span>samba_server<span class="w"> </span>start
</span></code></pre></div>
<h3 id="user-creation"><a class="toclink" href="../../../freebsd-13-%E5%AE%89%E8%A3%85-samba-server/#user-creation">User creation</a></h3>
<p>Now that the server is running, you can’t still access your files because you got no credentials to log in with. By default Samba relies on system users, so after you created your system user using <code>adduser</code>, enable it for Samba:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>pdbedit<span class="w"> </span>-a<span class="w"> </span>-u<span class="w"> </span>davd
</span></code></pre></div>
<p>You are prompted to enter a password which will be used to authenticate against Samba.</p>
<h3 id="_2"><a class="toclink" href="../../../freebsd-13-%E5%AE%89%E8%A3%85-samba-server/#_2">参考</a></h3>
<p><a href="https://www.davd.io/samba-fileserver-on-freebsd/">Samba fileserver on FreeBSD (Update FreeBSD 12)</a>
<a href="https://blog.vulnifo.com/2021/09/17/how-to-setup-nfs-and-samba-on-freebsd-13/">How-To: Setup NFS and Samba on FreeBSD 13</a></p>
    
  </div>
</article>
      
      
        
          



<nav class="md-pagination">
  
</nav>
        
      
    </div>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "navigation.sections", "navigation.instant", "navigation.path", "navigation.indexes", "navigation.top"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
    
  </body>
</html>